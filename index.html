<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TonCrime - Index</title>
  <style>
    /* ========= RESET ========= */
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:#000;
      font-family:Georgia, serif;
      display:flex;
      justify-content:center;
      align-items:center;
      height:100vh;
      user-select:none;
    }

    /* ========= TELEGRAM FRAME ========= */
    .app{
      width:390px;
      height:690px;
      position:relative;
      overflow:hidden;
      border-radius:26px;
      box-shadow:0 0 45px rgba(0,0,0,.85);
      background:#000;
    }

    .bg{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      object-fit:cover;
      z-index:0;
      filter:saturate(1.05) contrast(1.03);
    }

    :root{
      --glass: rgba(10,10,10,.42);
      --glass2: rgba(10,10,10,.58);
      --gold: rgba(255,215,0,.92);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.70);
      --green: rgba(58,255,166,.92);
      --amber: rgba(255,214,120,.95);
    }

    /* ========= TOP ROW ========= */
    .logo{
      position:absolute;
      top:10px; left:10px;
      height:54px;
      z-index:20;
      filter:drop-shadow(0 8px 16px rgba(0,0,0,.6));
    }

    .pill{
      position:absolute;
      top:10px;
      z-index:20;
      padding:6px 12px;
      border-radius:999px;
      background:rgba(0,0,0,.35);
      color:var(--text);
      font-weight:800;
      font-size:13px;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }
    .time-pill{ left:50%; transform:translateX(-50%); }
    .online-pill{ right:10px; display:flex; align-items:center; gap:8px; }
    .online-dot{
      width:10px; height:10px; border-radius:50%;
      background:#35ff6a;
      box-shadow:0 0 12px rgba(53,255,106,.65);
    }

    /* ========= HUD (zarif / Ã§erÃ§evesiz) ========= */
    .hud{
      position:absolute;
      top:62px;
      right:12px;
      width:258px;
      z-index:18;
      border-radius:16px;
      background:var(--glass);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      box-shadow:0 16px 42px rgba(0,0,0,.45);
      padding:10px 12px;
      color:var(--text);
    }
    .hud-top{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
      margin-bottom:8px;
    }
    .hud-name{
      font-weight:900;
      font-size:13px;
      color:var(--text);
      display:flex;
      align-items:center;
      gap:6px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width:130px;
    }
    .hud-weapon{
      text-align:right;
      font-weight:900;
      font-size:12px;
      color:var(--muted);
      line-height:1.15;
    }
    .hud-weapon .wname{ color:var(--text); font-weight:900; }
    .hud-weapon .wbonus{ color:var(--gold); font-weight:900; }

    .row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      font-size:12px;
      font-weight:800;
      margin:6px 0 4px;
      color:var(--text);
    }
    .row small{
      font-size:11px;
      color:var(--muted);
      font-weight:800;
    }

    .bar{
      width:100%;
      height:8px;
      border-radius:999px;
      background:rgba(255,255,255,.14);
      overflow:hidden;
      margin-bottom:8px;
    }
    .fill{
      height:100%;
      border-radius:999px;
      width:0%;
    }
    .energy-fill{ background:var(--green); }
    .xp-fill{ background:var(--amber); }

    .yton-row{
      display:flex;
      align-items:center;
      gap:8px;
      margin-top:6px;
      font-weight:900;
      font-size:12px;
      color:var(--text);
    }
    .yton-row img{
      height:16px;
      width:auto;
      filter:drop-shadow(0 3px 10px rgba(0,0,0,.45));
    }
    .yton-amount{
      font-weight:900;
      letter-spacing:.2px;
    }
    .hud-foot{
      margin-top:6px;
      display:flex;
      justify-content:space-between;
      font-size:11px;
      color:var(--muted);
      font-weight:900;
    }

    /* ========= SLIDE MENU (ORTA) ========= */
    .slider-wrap{
      position:absolute;
      left:0; right:0;
      top:50%;
      transform:translateY(-8%);
      z-index:12;
      padding:0 14px;
    }

    .slider{
      display:flex;
      gap:14px;
      overflow-x:auto;
      scroll-snap-type:x mandatory;
      -webkit-overflow-scrolling:touch;
      padding:10px 6px 8px 6px;
      scrollbar-width:none;
    }
    .slider::-webkit-scrollbar{ display:none; }

    .card{
      flex:0 0 auto;
      width:168px;
      scroll-snap-align:center;
      text-align:center;
      cursor:pointer;
      -webkit-tap-highlight-color:transparent;
    }
    .card img{
      width:168px;
      height:238px;
      border-radius:18px;
      object-fit:cover;
      border:2px solid rgba(255,215,0,.70);
      box-shadow:0 18px 42px rgba(0,0,0,.55);
      transition:transform .18s ease, filter .18s ease;
    }
    .card:active img{ transform:scale(.985); filter:brightness(1.06); }
    .card span{
      display:block;
      margin-top:8px;
      color:var(--gold);
      font-weight:900;
      letter-spacing:.3px;
      text-shadow:0 10px 24px rgba(0,0,0,.55);
    }

    .arrow{
      position:absolute;
      top:50%;
      transform:translateY(-50%);
      z-index:13;
      width:34px; height:34px;
      border-radius:12px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:30px;
      font-weight:900;
      color:var(--gold);
      background:rgba(0,0,0,.25);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      cursor:pointer;
      -webkit-tap-highlight-color:transparent;
    }
    .arrow.left{ left:8px; }
    .arrow.right{ right:8px; }

    /* ========= CHAT (bottom-sheet) ========= */
    .chat{
      position:absolute;
      left:10px; right:10px;
      bottom:10px;
      z-index:25;
      border-radius:18px;
      background:rgba(0,0,0,.45);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      box-shadow:0 18px 48px rgba(0,0,0,.55);
      overflow:hidden;
      height:52px;                 /* kapalÄ± */
      transition:height .22s ease;
    }
    .chat.open{ height:300px; }    /* aÃ§Ä±k */
    .chat-header{
      height:52px;
      display:flex;
      align-items:center;
      justify-content:center;
      color:var(--gold);
      font-weight:900;
      letter-spacing:1px;
      cursor:pointer;
      -webkit-tap-highlight-color:transparent;
    }
    .chat-messages{
      height: calc(100% - 52px - 46px);
      overflow-y:auto;
      padding:10px 10px 6px 10px;
      color:var(--text);
      font-size:12px;
    }
    .chat-messages .msg{ margin:6px 0; }
    .chat-input{
      height:46px;
      display:flex;
      gap:8px;
      padding:8px;
      border-top:1px solid rgba(255,255,255,.10);
    }
    .chat-input input{
      flex:1;
      border:none;
      outline:none;
      border-radius:12px;
      padding:10px 12px;
      background:rgba(255,255,255,.10);
      color:var(--text);
      font-size:12px;
    }
    .chat-input button{
      min-width:92px;
      border:none;
      border-radius:12px;
      background:rgba(255,215,0,.92);
      color:#111;
      font-weight:900;
      cursor:pointer;
    }
  </style>
</head>
<body>

  <div class="app" id="app">
    <img class="bg" src="assets/background.jpg" alt="bg">
    <img class="logo" src="assets/logo.png" alt="logo">

    <div class="pill time-pill" id="timePill">--:-- --.--</div>
    <div class="pill online-pill" id="onlinePill"><span class="online-dot"></span><span id="onlineCount">0</span></div>

    <div class="hud" id="hud">
      <div class="hud-top">
        <div class="hud-name">ðŸ‘¤ <span id="playerName">Player01</span></div>
        <div class="hud-weapon">
          <div class="wname" id="weaponName">Tabanca</div>
          <div class="wbonus" id="weaponBonus">(+10%)</div>
          <div style="margin-top:4px;"><small id="energyTimerText">+1 enerji: --:--</small></div>
        </div>
      </div>

      <div class="row">
        <div id="energyText">Enerji: âš¡0/100</div>
      </div>
      <div class="bar"><div class="fill energy-fill" id="energyFill"></div></div>

      <div class="row">
        <div id="xpText">XP: 0/1000 (Lv 1)</div>
        <small id="lvCapText">Lv cap: 50</small>
      </div>
      <div class="bar"><div class="fill xp-fill" id="xpFill"></div></div>

      <div class="yton-row">
        <img src="assets/yton.png" alt="yton">
        <div>YTON:</div>
        <div class="yton-amount" id="ytonAmount">0</div>
      </div>

      <div class="hud-foot">
        <div id="bonusText">Bonus: +0%</div>
        <div id="levelLockText">Level cap aktif</div>
      </div>
    </div>

    <!-- SLIDE MENU (ORTA) -->
    <div class="slider-wrap">
      <div class="arrow left" id="leftArrow">â€¹</div>
      <div class="arrow right" id="rightArrow">â€º</div>

      <div class="slider" id="slider">
        <div class="card" data-go="missions.html">
          <img src="assets/missions.jpg" alt="missions">
          <span>GÃ¶revler</span>
        </div>
        <div class="card" data-go="pvp.html">
          <img src="assets/pvp.jpg" alt="pvp">
          <span>PvP</span>
        </div>
        <div class="card" data-go="nightclub.html">
          <img src="assets/nightclub.jpg" alt="nightclub">
          <span>Gece KulÃ¼bÃ¼</span>
        </div>
        <div class="card" data-go="coffeeshop.html">
          <img src="assets/coffeeshop.jpg" alt="coffeeshop">
          <span>Coffeeshop</span>
        </div>
        <div class="card" data-go="xxx.html">
          <img src="assets/xxx.jpg" alt="xxx">
          <span>Genel Ev</span>
        </div>
        <div class="card" data-go="weapons.html">
          <img src="assets/weapons.jpg" alt="weapons">
          <span>Silah TÃ¼ccarÄ±</span>
        </div>
      </div>
    </div>

    <!-- CHAT (Bottom Sheet) -->
    <div class="chat" id="chat">
      <div class="chat-header" id="chatHeader">CHAT</div>
      <div class="chat-messages" id="chatMessages"></div>
      <div class="chat-input">
        <input id="chatInput" type="text" placeholder="Mesaj..." />
        <button id="chatSend">GÃ¶nder</button>
      </div>
    </div>
  </div>

<script>
/* =========================================================
   TONCRIME SINGLE-FILE CORE (Player + HUD + Chat + Slider)
   ========================================================= */

(function(){
  /* ---------- STORAGE KEYS ---------- */
  const K_PLAYER = "tc_player_v1";
  const K_CHAT   = "tc_chat_v1";

  /* ---------- CONSTANTS ---------- */
  const ENERGY_MAX = 100;                 // sabit (reklama teÅŸvik)
  const ENERGY_REGEN_MS = 5 * 60 * 1000;  // 5 dk = 1 enerji
  const LEVEL_CAP = 50;

  /* ---------- DEFAULT PLAYER ---------- */
  const defaultPlayer = {
    name: "Player01",
    energy: 60,
    energyMax: ENERGY_MAX,
    xp: 0,
    xpMax: 1000,
    level: 1,
    yton: 1000,
    weapon: { name:"Tabanca", bonus: 0.10 }, // +10%
    lastEnergyTs: Date.now()
  };

  function safeParse(json, fallback){
    try { return JSON.parse(json) ?? fallback; } catch { return fallback; }
  }

  /* ---------- LOAD/SAVE PLAYER ---------- */
  function loadPlayer(){
    const saved = safeParse(localStorage.getItem(K_PLAYER), null);
    const p = Object.assign({}, defaultPlayer, saved || {});
    // sabit max enerji + cap
    p.energyMax = ENERGY_MAX;
    if (!p.weapon) p.weapon = { name:"Tabanca", bonus:0.10 };
    if (typeof p.weapon.bonus !== "number") p.weapon.bonus = 0.10;
    if (!p.lastEnergyTs) p.lastEnergyTs = Date.now();
    // enerji regen hesapla (sayfa aÃ§Ä±lÄ±nca)
    applyEnergyRegen(p);
    // level cap uygula
    if (p.level > LEVEL_CAP) p.level = LEVEL_CAP;
    savePlayer(p);
    return p;
  }

  function savePlayer(p){
    localStorage.setItem(K_PLAYER, JSON.stringify(p));
  }

  function applyEnergyRegen(p){
    const now = Date.now();
    const elapsed = Math.max(0, now - p.lastEnergyTs);
    const gained = Math.floor(elapsed / ENERGY_REGEN_MS);
    if (gained > 0){
      p.energy = Math.min(p.energyMax, p.energy + gained);
      p.lastEnergyTs = p.lastEnergyTs + gained * ENERGY_REGEN_MS;
    }
  }

  /* ---------- CHAT STORE ---------- */
  function loadChat(){
    const arr = safeParse(localStorage.getItem(K_CHAT), []);
    return Array.isArray(arr) ? arr : [];
  }
  function saveChat(arr){
    localStorage.setItem(K_CHAT, JSON.stringify(arr));
  }

  /* ---------- UI REFS ---------- */
  const timePill = document.getElementById("timePill");
  const onlineCount = document.getElementById("onlineCount");

  const playerName = document.getElementById("playerName");
  const weaponName = document.getElementById("weaponName");
  const weaponBonus = document.getElementById("weaponBonus");
  const bonusText = document.getElementById("bonusText");

  const energyText = document.getElementById("energyText");
  const energyFill = document.getElementById("energyFill");
  const energyTimerText = document.getElementById("energyTimerText");

  const xpText = document.getElementById("xpText");
  const xpFill = document.getElementById("xpFill");

  const ytonAmount = document.getElementById("ytonAmount");

  const slider = document.getElementById("slider");
  const leftArrow = document.getElementById("leftArrow");
  const rightArrow = document.getElementById("rightArrow");

  const chat = document.getElementById("chat");
  const chatHeader = document.getElementById("chatHeader");
  const chatMessages = document.getElementById("chatMessages");
  const chatInput = document.getElementById("chatInput");
  const chatSend = document.getElementById("chatSend");

  /* ---------- STATE ---------- */
  let player = loadPlayer();
  let chatData = loadChat();

  /* ---------- TIME + ONLINE ---------- */
  function pad2(n){ return String(n).padStart(2,"0"); }
  function tickTime(){
    const d = new Date();
    const hh = pad2(d.getHours());
    const mm = pad2(d.getMinutes());
    const dd = pad2(d.getDate());
    const mo = pad2(d.getMonth()+1);
    timePill.textContent = `${hh}:${mm} ${dd}.${mo}`;
  }

  // online fake (stabil gÃ¶rÃ¼nsÃ¼n)
  function initOnline(){
    const base = 170 + Math.floor(Math.random()*60); // 170-229
    onlineCount.textContent = String(base);
    // hafif oynat
    setInterval(()=>{
      const cur = Number(onlineCount.textContent||base);
      const next = Math.max(80, cur + (Math.random()<0.5?-1:1) * (Math.random()<0.6?1:2));
      onlineCount.textContent = String(next);
    }, 4000);
  }

  /* ---------- HUD RENDER ---------- */
  function clamp01(x){ return Math.max(0, Math.min(1, x)); }

  function formatMMSS(ms){
    const s = Math.max(0, Math.ceil(ms/1000));
    const m = Math.floor(s/60);
    const r = s % 60;
    return `${pad2(m)}:${pad2(r)}`;
  }

  function renderHUD(){
    // regen uygula
    applyEnergyRegen(player);
    savePlayer(player);

    playerName.textContent = player.name;
    weaponName.textContent = player.weapon?.name ?? "Tabanca";
    const b = player.weapon?.bonus ?? 0;
    weaponBonus.textContent = `(+${Math.round(b*100)}%)`;
    bonusText.textContent = `Bonus: +${Math.round(b*100)}%`;

    // energy
    energyText.textContent = `Enerji: âš¡${player.energy}/${player.energyMax}`;
    energyFill.style.width = `${Math.round(clamp01(player.energy/player.energyMax)*100)}%`;

    // next energy timer
    if (player.energy >= player.energyMax){
      energyTimerText.textContent = `+1 enerji: DOLU`;
    } else {
      const now = Date.now();
      const nextTick = player.lastEnergyTs + ENERGY_REGEN_MS;
      const remain = nextTick - now;
      energyTimerText.textContent = `+1 enerji: ${formatMMSS(remain)}`;
    }

    // xp + level cap
    const lv = Math.min(player.level, LEVEL_CAP);
    xpText.textContent = `XP: ${player.xp}/${player.xpMax} (Lv ${lv})`;
    xpFill.style.width = `${Math.round(clamp01(player.xp/player.xpMax)*100)}%`;

    // yton
    ytonAmount.textContent = String(player.yton);
  }

  /* ---------- CHAT UI ---------- */
  function renderChat(){
    chatMessages.innerHTML = "";
    for (const m of chatData){
      const div = document.createElement("div");
      div.className = "msg";
      div.textContent = m;
      chatMessages.appendChild(div);
    }
    chatMessages.scrollTop = chatMessages.scrollHeight;
  }

  function pushChatMessage(text){
    const t = (text || "").trim();
    if (!t) return;
    const line = `${player.name}: ${t}`;
    chatData.push(line);
    // limit
    if (chatData.length > 200) chatData = chatData.slice(-200);
    saveChat(chatData);
    renderChat();
  }

  function toggleChat(){
    chat.classList.toggle("open");
    // aÃ§Ä±lÄ±nca en alta
    if (chat.classList.contains("open")){
      setTimeout(()=> chatMessages.scrollTop = chatMessages.scrollHeight, 50);
      setTimeout(()=> chatInput.focus(), 80);
    }
  }

  /* ---------- SLIDER NAV ---------- */
  function slideBy(px){
    slider.scrollBy({ left: px, behavior: "smooth" });
  }

  function bindMenuClicks(){
    slider.querySelectorAll(".card").forEach(card=>{
      card.addEventListener("click", ()=>{
        const go = card.getAttribute("data-go");
        if (go) window.location.href = go;
      });
    });
  }

  /* ---------- INIT ---------- */
  function init(){
    // time
    tickTime();
    setInterval(tickTime, 1000);

    // online
    initOnline();

    // hud render loop
    renderHUD();
    setInterval(renderHUD, 1000);

    // chat
    renderChat();
    chatHeader.addEventListener("click", toggleChat);
    chatSend.addEventListener("click", ()=>{ pushChatMessage(chatInput.value); chatInput.value=""; });
    chatInput.addEventListener("keydown", (e)=>{
      if (e.key === "Enter"){
        pushChatMessage(chatInput.value);
        chatInput.value="";
      }
    });

    // slider arrows
    leftArrow.addEventListener("click", ()=> slideBy(-190));
    rightArrow.addEventListener("click", ()=> slideBy(190));
    bindMenuClicks();
  }

  init();
})();
</script>

</body>
  </html>
