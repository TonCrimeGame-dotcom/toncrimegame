<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>GÃ¶revler</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">

<style>
body{margin:0;background:#000;color:#fff;font-family:Arial}
.topbar{height:60px;background:#111;display:flex;align-items:center;padding:0 15px}
.logo{color:#f90;font-weight:bold;margin-right:20px}
.stats{margin-left:auto;font-size:13px}
.wrapper{display:flex;padding:15px}
.left{width:60%}
.right{width:40%;padding-left:15px}
.mission{background:#111;padding:12px;border-radius:10px;margin-bottom:12px}
.mission button{width:100%;margin-top:8px;padding:10px;background:#f90;border:none;border-radius:8px;font-weight:bold;cursor:pointer}
.table{background:#111;padding:10px;border-radius:10px}
.row{border-bottom:1px solid #222;padding:5px 0;font-size:13px}
.success{color:#0f0}
.fail{color:#f33}
.hospital{color:#ff4444;font-weight:bold}
</style>
</head>
<body>

<div class="topbar">
<div class="logo">ğŸ”¥ YeraltÄ± Åehri</div>
<div class="stats">
Level: <span id="lvl"></span> |
âš¡ <span id="energy"></span> |
ğŸ’° <span id="yton"></span>
<span id="hospitalInfo"></span>
</div>
</div>

<div class="wrapper">
<div class="left" id="missions"></div>

<div class="right">
<div class="table">
<b>ğŸ“Š Ä°statistik</b>
<div id="statsBox"></div>
<hr>
<b>ğŸ•’ GeÃ§miÅŸ</b>
<div id="historyBox"></div>
</div>
</div>
</div>

<script>
const VERSION = "1.0.0";

/* PLAYER INIT */
function getPlayer(){
let p = JSON.parse(localStorage.getItem("player_v1"));
if(!p){
p={
level:1,
xp:0,
xpNext:100,
energy:80,
yton:120,
hospitalUntil:0,
missionStats:{success:0,fail:0},
missionHistory:[],
missionRepeat:{}
}
savePlayer(p);
}
return p;
}

function savePlayer(p){
localStorage.setItem("player_v1",JSON.stringify(p));
}

/* UI */
function updateUI(){
let p=getPlayer();

document.getElementById("lvl").innerText=p.level;
document.getElementById("energy").innerText=p.energy;
document.getElementById("yton").innerText=p.yton;

if(Date.now()<p.hospitalUntil){
let remain=Math.floor((p.hospitalUntil-Date.now())/1000);
document.getElementById("hospitalInfo").innerHTML=" | ğŸ¥ "+remain+"s";
}else{
document.getElementById("hospitalInfo").innerHTML="";
}
}

/* MISSIONS */
const missionsData=[
{id:1,name:"Sokak TemizliÄŸi",energy:10,xp:20,yton:50,risk:20},
{id:2,name:"KaÃ§ak Mal",energy:15,xp:30,yton:80,risk:25},
{id:3,name:"Gece BaskÄ±nÄ±",energy:20,xp:50,yton:120,risk:35}
];

function loadMissions(){
const box=document.getElementById("missions");
box.innerHTML="";

missionsData.forEach(m=>{
let div=document.createElement("div");
div.className="mission";

div.innerHTML=
"<b>"+m.name+"</b><br>"+
"âš¡ "+m.energy+" | â­ "+m.xp+" | ğŸ’° "+m.yton+" | Risk "+m.risk+"%";

let btn=document.createElement("button");
btn.innerText="BaÅŸlat";

btn.addEventListener("click",function(){
startMission(m.id);
});

div.appendChild(btn);
box.appendChild(div);
});
}

/* MISSION */
function startMission(id){
let p=getPlayer();
let m=missionsData.find(x=>x.id===id);

if(Date.now()<p.hospitalUntil){
alert("ğŸ¥ Hastanedesin!");
return;
}

if(p.energy<m.energy){
alert("âš¡ Enerji yetersiz!");
return;
}

p.energy-=m.energy;

let repeat=p.missionRepeat[id]||0;
let finalRisk=repeat>=10?m.risk*2:m.risk;
let success=Math.random()*100>finalRisk;

if(success){
p.xp+=m.xp;
p.yton+=m.yton;
p.missionStats.success++;
alert("âœ… BaÅŸarÄ±lÄ±!");
}else{
let loss=Math.floor(m.yton/2);
p.yton=Math.max(0,p.yton-loss);
p.missionStats.fail++;
alert("âŒ BaÅŸarÄ±sÄ±z!");

if(Math.random()<0.5){
p.hospitalUntil=Date.now()+600000;
alert("ğŸ¥ Hastaneye dÃ¼ÅŸtÃ¼n!");
}
}

if(p.xp>=p.xpNext){
p.level++;
p.xp=0;
p.xpNext+=100;
alert("ğŸ‰ Level AtladÄ±n!");
}

p.missionRepeat[id]=repeat+1;

p.missionHistory.unshift({
name:m.name,
time:new Date().toLocaleTimeString(),
result:success?"success":"fail"
});

savePlayer(p);
updateUI();
renderStats();
}

/* STATS */
function renderStats(){
let p=getPlayer();

document.getElementById("statsBox").innerHTML=
"BaÅŸarÄ±lÄ±: "+p.missionStats.success+
"<br>BaÅŸarÄ±sÄ±z: "+p.missionStats.fail;

let history="";
p.missionHistory.slice(0,10).forEach(h=>{
history+="<div class='row "+h.result+"'>"+
h.time+" - "+h.name+
"</div>";
});

document.getElementById("historyBox").innerHTML=history;
}

/* ENERGY REGEN */
setInterval(()=>{
let p=getPlayer();
if(p.energy<100){
p.energy+=1;
savePlayer(p);
updateUI();
}
},60000);

/* INIT */
updateUI();
loadMissions();
renderStats();
</script>

</body>
</html>
